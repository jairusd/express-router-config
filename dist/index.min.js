"use strict";function sortRoutes(r){if(!Array.isArray(r))throw new Error("argument is expected to be an array of object, ["+typeof r+"] type is given.");return groupSortWildcards(r=groupBySlashes(r))}function groupSortWildcards(r){return Object.entries(r).map(function(r){r[0];return r[1].sort(wildCard)}).reduce(function(r,t){return t.concat(r)})}function groupBySlashes(r){return r.reduce(function(r,t){var e=t.match.split("/").length;return r[e]=r[e]||[],r[e].push(t),r},{})}function wildCard(r,t){var e=r.match.match(/\/(\:[a-zA-Z0-9_-]{1,})/g),n=t.match.match(/\/(\:[a-zA-Z0-9_-]{1,})/g),a=r.match.split("/"),o=t.match.split("/"),i=o?o.length:0;if(!e)return-1;if(!n)return 1;if(e.length===i-1)return 1;if(n.length===i-1)return-1;var u=e.map(function(r){return a.indexOf(r.replace("/",""))}).reduce(function(r,t){return(r+t)/a.length});return n.map(function(r){return o.indexOf(r.replace("/",""))}).reduce(function(r,t){return(r+t)/o.length})-u}function normalizeEndpoint(r){return"/"+r.replace(/^\/|\/$/,"")}function routeTranslator(r,t,e){return Array.isArray(r)&&r.length?r.map(function(r){return r.group?routeTranslator(r.routes,r.middleware,r.group):routeTranslator(r,t,e)}):(t=mapMiddleware([t,r.middleware]),e=appendPrefix(r.match,e),{method:r.method,match:normalizeEndpoint(e),middleware:t,action:r.action})}function mapMiddleware(r){var t=[];return r.forEach(function(r){Array.isArray(r)?t.push.apply(t,r):t.push(r)}),t.filter(function(r){return r})}function appendPrefix(r,t){return void 0===t&&(t=!1),t&&(r=(""+t+r.match).replace("//","/")),r}function groupMiddleware(r){var t={pre:[],post:[]};return r.forEach(function(r){isValidArray(r)?isValidMiddlewarePosition(r[0])&&t[r[0]].push(r[1]):t.pre.push(r)}),[t.pre,t.post]}function isValidMiddlewarePosition(r){return"pre"===r||"post"===r}function isValidArray(r){return Array.isArray(r)&&1<r.length}function configureRoutes(o,i){return void 0===i&&(i=!1),function(r){return(r=r.length?sortRoutes([].concat.apply([],routeTranslator(r))):[]).map(function(r){i&&console.log("Routing: ["+r.method+"] - "+r.match);var t=[r.action];if(r.middleware.length){var e=groupMiddleware(r.middleware),n=e[0],a=e[1];t=n.concat(t,a)}return o[r.method].apply(o,[r.match].concat(t))})}}module.exports=configureRoutes;
