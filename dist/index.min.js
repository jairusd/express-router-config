"use strict";function sortRoutes(r){if(!Array.isArray(r))throw new Error("argument is expected to be an array of object, ["+typeof r+"] type is given.");return groupSortWildcards(r=groupBySlashes(r))}function groupSortWildcards(r){return Object.entries(r).map(function(r){r[0];return r[1].sort(wildCard)}).reduce(function(r,t){return t.concat(r)})}function groupBySlashes(r){return r.reduce(function(r,t){var e=t.match.split("/").length;return r[e]=r[e]||[],r[e].push(t),r},{})}function wildCard(r,t){var e=r.match.match(/\/(\:[a-zA-Z0-9_-]{1,})/g),n=t.match.match(/\/(\:[a-zA-Z0-9_-]{1,})/g),o=r.match.split("/"),u=t.match.split("/"),a=u?u.length:0;if(!e)return-1;if(!n)return 1;if(e.length===a-1)return 1;if(n.length===a-1)return-1;var i=e.map(function(r){return o.indexOf(r.replace("/",""))}).reduce(function(r,t){return(r+t)/o.length});return n.map(function(r){return u.indexOf(r.replace("/",""))}).reduce(function(r,t){return(r+t)/u.length})-i}function normalizeEndpoint(r){return"/"+r.replace(/^\/|\/$/,"")}function routeTranslator(r,t,e){return Array.isArray(r)&&r.length?r.map(function(r){return r.group?routeTranslator(r.routes,r.middleware,r.group):routeTranslator(r,t,e)}):(t=[t,r.middleware].filter(function(r){return r}),e=appendPrefix(r.match,e),{method:r.method,match:normalizeEndpoint(e),middleware:t,action:r.action})}function appendPrefix(r,t){return void 0===t&&(t=!1),t&&(r=(""+t+r.match).replace("//","/")),r}function configureRoutes(e,n){return void 0===n&&(n=!1),function(r){return(r=r.length?sortRoutes([].concat.apply([],routeTranslator(r))):[]).map(function(r){n&&console.log("Routing: ["+r.method+"] - "+r.match);var t=[r.action];return r.middleware.length&&(t=r.middleware.concat(t)),e[r.method].apply(e,[r.match].concat(t))})}}module.exports=configureRoutes;
